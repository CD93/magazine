Popin=function(e,t){"use strict";if(!(this instanceof Popin))return new Popin(t);var n=this;n.options={errorMsg:"Oups ! Il semblerait quâ€™il y ai eu une erreur...",attr:"href",type:"ajax",content:"",gallery:!1,onReady:function(){}},n.options.errorMarkup='<div class="popin-section">'+n.options.errorMsg+"</div>",n.options.contentMarkup='<div class="popin-section">%content%</div>',$.extend(!0,n.options,t);var o=n.options;return n.$holder=$("#js-popin-holder"),n.$popin=$("#js-popin"),n.$content=$("#js-popin-content"),n.$loader=$("#js-popin-loader"),n.$bg=$("#js-popin-bg"),n.$closeBtn=$("#js-popin-close"),n.$btn=$(e),n.isOpen=!1,TweenLite.set(n.$bg,{opacity:0,scaleX:0,scaleY:0}),TweenLite.set(n.$loader,{opacity:0,scaleX:0,scaleY:0,x:"-50%",y:"-50%"}),TweenLite.set(n.$popin,{opacity:0}),n.$btn&&n.$btn.on("click",{instance:n},n.onBtnClick),n.$holder.on("click",function(e){var t=e.target||e.srcElement;"js-popin-cell"===t.getAttribute("id")&&n.isOpen&&n.close()}),n.iframe=function(e){n.isOpen=!0;var t=n.$popin[0].getBoundingClientRect();TweenLite.to(n.$loader,.6,{x:"-50%",y:"-50%",width:t.width,height:t.height,borderRadius:"0%",onComplete:function(){n.isOpen=!0;var t=document.createElement("iframe");t.frameBorder=0,t.style.opacity=0,t.onload=function(){TweenLite.to(t,1,{opacity:1,onComplete:function(){TweenLite.set(n.$popin,{opacity:1}),TweenLite.set(n.$loader,{opacity:0,scaleX:0,scaleY:0,width:"4em",height:"4em",borderRadius:"50%"})}})},n.$content.append(t),t.setAttribute("src",e),n.$closeBtn.on("click",function(e){e.preventDefault(),n.close()}),$document.bind("keyup",n.keyup)}})},n.ajax=function(e){$.ajax({url:e}).done(function(e){n.$content.append(e),n.$holder.addClass("has-popin")}).fail(function(){n.$content.append(o.errorMarkup),n.$holder.addClass("has-popin has-error")}).always(function(e){var t=n.$popin[0].getBoundingClientRect();n.$loader.addClass("is-morphing"),TweenLite.to(n.$loader,.6,{x:"-50%",y:"-50%",width:t.width,height:t.height,borderRadius:"0%",onComplete:function(){TweenLite.to(n.$popin,.6,{opacity:1,ease:Expo.easeOut,onComplete:function(){n.$loader.removeClass("is-morphing"),TweenLite.set(n.$loader,{opacity:0,scaleX:0,scaleY:0,width:"4em",height:"4em",borderRadius:"50%"}),n.isOpen=!0}}),n.$closeBtn.on("click",function(e){e.preventDefault(),n.close()}),"function"==typeof o.onReady&&o.onReady(n),$(document).bind("keyup",n.keyup)}})})},n.text=function(e){n.$content.append(o.contentMarkup.replace("%content%",o.content));var t=n.$popin[0].getBoundingClientRect();n.$loader.addClass("is-morphing"),TweenLite.to(n.$loader,.7,{delay:.1,x:"-50%",y:"-50%",opacity:1,scaleX:1,scaleY:1,width:t.width,height:t.height,borderRadius:"0%",onComplete:function(){TweenLite.to(n.$popin,.6,{opacity:1,ease:Expo.easeOut,onComplete:function(){n.$loader.removeClass("is-morphing"),TweenLite.set(n.$loader,{opacity:0,scaleX:0,scaleY:0,width:"4em",height:"4em",borderRadius:"50%"}),n.isOpen=!0}}),n.$closeBtn.on("click",function(e){e.preventDefault(),n.close()}),"function"==typeof o.onReady&&o.onReady(n),$(document).bind("keyup",n.keyup)}})},n.image=function(e){$(document).off("keyup",n.keyup);var t=new Image;t.addEventListener("load",function(){n.$content.html(t),n.$holder.addClass("has-popin");var e=n.$popin[0].getBoundingClientRect();n.$loader.addClass("is-morphing"),TweenLite.to(n.$loader,.6,{x:"-50%",y:"-50%",width:e.width,height:e.height,borderRadius:"0%",onComplete:function(){TweenLite.to(n.$popin,.6,{opacity:1,ease:Expo.easeOut,onComplete:function(){n.$loader.removeClass("is-morphing"),TweenLite.set(n.$loader,{opacity:0,scaleX:0,scaleY:0,width:"4em",height:"4em",borderRadius:"50%"}),n.isOpen=!0}}),n.$closeBtn.on("click",function(e){e.preventDefault(),n.close()}),"function"==typeof o.onReady&&o.onReady(n),$(document).on("keyup",n.keyup)}})}),t.src=e},n.keyup=function(e){if(27===e.which&&n.close(),n.options.gallery){var t;39===e.which&&n.current<n.$btn.length&&(n.current+=1,t=n.$btn.eq(n.current).attr(n.options.attr),n.image(t)),37===e.which&&n.current>0&&(n.current-=1,t=n.$btn.eq(n.current).attr(n.options.attr),n.image(t))}},n},Popin.prototype={open:function(e,t){"use strict";var n=this;return e=e?e:n.options.content,t=t?t:n.options.type,$("html").addClass("is-no-scroll"),n.$holder.addClass("has-popin"),n.$holder.addClass("has-"+t),TweenLite.to(n.$bg,.6,{opacity:1,scaleX:1,scaleY:1}),"text"===t?n[t](e):TweenLite.to(n.$loader,.6,{opacity:1,scaleX:1,scaleY:1,delay:.3,onComplete:function(){n[t](e)}}),n},close:function(){"use strict";var e=this;return $("html").removeClass("is-no-scroll"),e.$loader.hasClass("is-morphing")&&(e.$loader.removeClass("is-morphing"),TweenLite.set(e.$loader,{opacity:0,scaleX:0,scaleY:0,width:"4em",height:"4em",borderRadius:"50%"})),TweenLite.to(e.$popin,.4,{opacity:0,scaleX:0,scaleY:0}),TweenLite.to(e.$bg,.6,{delay:.2,opacity:0,scaleX:0,scaleY:0,onComplete:function(){TweenLite.set(e.$popin,{scaleX:1,scale:1}),e.$holder.removeClass("has-popin has-error has-iframe"),e.$content.html(""),e.isOpen=!1,$document.off("keyup",e.keyup)}}),e},onBtnClick:function(e){"use strict";e.preventDefault();var t=e.data.instance,n=$(this),o="text"===t.options.type?t.options.content:n.attr(t.options.attr);t.isOpen||t.open(o,t.options.type),t.options.gallery&&(t.current=t.$btn.index(n))},updateTriggers:function(e){"use strict";var t=this;return t.$btn.off("click",t.onBtnClick),t.$btn=$(e),t.$btn.on("click",{instance:t},t.onBtnClick),t}};